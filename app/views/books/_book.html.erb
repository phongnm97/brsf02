<% if BookStatus.user_book(current_user.id, book.id).first
    book_status = BookStatus.user_book(current_user.id, book.id).first
    status = book_status.status
  else
    book_status = BookStatus.new
    status = "unread"
  end
%>

<tr data-status="<%= status %>" class="book_<%= book.id %>">
  <td>
    <a href="javascript:;" class="star star-checked">
      <i class="glyphicon glyphicon-heart"></i>
    </a>
  </td>
  <td>
    <div class="media">
      <div class="media-body">
        <span class="media-meta pull-right"><%= book.publish_date %></span>
        <h4 class="title">
          <%= book.title %>
          <span class="pull-right book_status" status=<%= status %>>
            <%= status %>
          </span>
        </h4>
          <span class="summary"><%= book.author %></span>
          <span class="summary"><%= book.author %></span>
          <%= form_for(book_status, :html => { class: "function pull-right "}, remote: true) do |f| %>
             <div><%= hidden_field_tag :user_id, current_user.id %></div>
             <div><%= hidden_field_tag :book_id, book.id %></div>
             <div><%= hidden_field_tag :status, "as_read"%></div>
            <%= f.submit "Mark as read", class: "btn-xs btn-warning" %>
          <% end %>
          <%= form_for(book_status, :html => { class: "function pull-right "}, remote: true) do |f| %>
             <div><%= hidden_field_tag :book_id, book.id %></div>
             <div><%= hidden_field_tag :status, "reading"%></div>
            <%= f.submit "Mark as reading", class: "btn-xs btn-success" %>
          <% end %>
          <% if book_status.id %>
            <%= link_to t(".mark_as_unread"), book_status_path(book_status), method: :delete, class: "btn btn-xs btn-danger" %>
          <% end %>
      </div>
    </div>
  </td>
</tr>
